"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.verifyJWT = exports.getJWTProtectedHeader = exports.signJWT = void 0;
const jose_1 = require("jose");
const format_1 = require("./format");
async function signJWT(payload, secret, kid) {
    return await new jose_1.SignJWT(payload)
        .setProtectedHeader({ alg: 'EdDSA', kid })
        .sign((0, format_1.importPrivateKey)(secret));
}
exports.signJWT = signJWT;
function getJWTProtectedHeader(jwt) {
    return (0, jose_1.decodeProtectedHeader)(jwt);
}
exports.getJWTProtectedHeader = getJWTProtectedHeader;
async function verifyJWT(jwt, publicKey, keyFormat = 'ed25519-raw') {
    return (0, jose_1.jwtVerify)(jwt, (0, format_1.importPublicKey)(publicKey, keyFormat), {
        algorithms: ['EdDSA', 'RS256'],
    });
}
exports.verifyJWT = verifyJWT;
//# sourceMappingURL=jwt.js.map